Description: Drop unused platform-specific context definitions
Author: Stephen Kitt <steve@sk2.org>

--- a/mingw-w64-tools/widl/include/winbase.h
+++ b/mingw-w64-tools/widl/include/winbase.h
@@ -156,13 +156,6 @@
     } u;
 } DEBUG_EVENT, *LPDEBUG_EVENT;
 
-typedef PCONTEXT LPCONTEXT;
-typedef PEXCEPTION_RECORD LPEXCEPTION_RECORD;
-typedef PEXCEPTION_POINTERS LPEXCEPTION_POINTERS;
-
-typedef LONG (CALLBACK *PTOP_LEVEL_EXCEPTION_FILTER)(PEXCEPTION_POINTERS);
-typedef PTOP_LEVEL_EXCEPTION_FILTER LPTOP_LEVEL_EXCEPTION_FILTER;
-
 #define OFS_MAXPATHNAME 128
 typedef struct _OFSTRUCT
 {
@@ -1767,7 +1760,6 @@
 WINADVAPI  BOOL        WINAPI AddAuditAccessAceEx(PACL,DWORD,DWORD,DWORD,PSID,BOOL,BOOL);
 WINADVAPI  BOOL        WINAPI AddMandatoryAce(PACL,DWORD,DWORD,DWORD,PSID);
 WINBASEAPI VOID        WINAPI AddRefActCtx(HANDLE);
-WINBASEAPI PVOID       WINAPI AddVectoredExceptionHandler(ULONG,PVECTORED_EXCEPTION_HANDLER);
 WINADVAPI  BOOL        WINAPI AdjustTokenGroups(HANDLE,BOOL,PTOKEN_GROUPS,DWORD,PTOKEN_GROUPS,PDWORD);
 WINADVAPI  BOOL        WINAPI AccessCheck(PSECURITY_DESCRIPTOR,HANDLE,DWORD,PGENERIC_MAPPING,PPRIVILEGE_SET,LPDWORD,LPDWORD,LPBOOL);
 WINADVAPI  BOOL        WINAPI AccessCheckAndAuditAlarmA(LPCSTR,LPVOID,LPSTR,LPSTR,PSECURITY_DESCRIPTOR,DWORD,PGENERIC_MAPPING,BOOL,LPDWORD,LPBOOL,LPBOOL);
@@ -1827,7 +1819,6 @@
 WINBASEAPI BOOL        WINAPI ConnectNamedPipe(HANDLE,LPOVERLAPPED);
 WINBASEAPI BOOL        WINAPI ContinueDebugEvent(DWORD,DWORD,DWORD);
 WINBASEAPI HANDLE      WINAPI ConvertToGlobalHandle(HANDLE hSrc);
-WINBASEAPI BOOL        WINAPI CopyContext(CONTEXT*, DWORD, CONTEXT*);
 WINBASEAPI BOOL        WINAPI CopyFileA(LPCSTR,LPCSTR,BOOL);
 WINBASEAPI BOOL        WINAPI CopyFileW(LPCWSTR,LPCWSTR,BOOL);
 #define                       CopyFile WINELIB_NAME_AW(CopyFile)
@@ -2301,7 +2292,6 @@
 WINBASEAPI DWORD       WINAPI GetTempPathA(DWORD,LPSTR);
 WINBASEAPI DWORD       WINAPI GetTempPathW(DWORD,LPWSTR);
 #define                       GetTempPath WINELIB_NAME_AW(GetTempPath)
-WINBASEAPI BOOL        WINAPI GetThreadContext(HANDLE,CONTEXT *);
 WINBASEAPI DWORD       WINAPI GetThreadErrorMode(void);
 WINBASEAPI DWORD       WINAPI GetThreadId(HANDLE);
 WINBASEAPI BOOL        WINAPI GetThreadIOPendingFlag(HANDLE,PBOOL);
@@ -2338,7 +2328,6 @@
 WINBASEAPI UINT        WINAPI GetWindowsDirectoryW(LPWSTR,UINT);
 #define                       GetWindowsDirectory WINELIB_NAME_AW(GetWindowsDirectory)
 WINBASEAPI UINT        WINAPI GetWriteWatch(DWORD,LPVOID,SIZE_T,LPVOID*,ULONG_PTR*,ULONG*);
-WINBASEAPI BOOL        WINAPI GetXStateFeaturesMask(CONTEXT*,DWORD64*);
 WINBASEAPI ATOM        WINAPI GlobalAddAtomA(LPCSTR);
 WINBASEAPI ATOM        WINAPI GlobalAddAtomW(LPCWSTR);
 #define                       GlobalAddAtom WINELIB_NAME_AW(GlobalAddAtom)
@@ -2381,8 +2370,6 @@
 WINBASEAPI BOOL        WINAPI InitAtomTable(DWORD);
 WINADVAPI  BOOL        WINAPI InitializeAcl(PACL,DWORD,DWORD);
 WINBASEAPI VOID        WINAPI InitializeConditionVariable(PCONDITION_VARIABLE);
-WINBASEAPI BOOL        WINAPI InitializeContext(void *,DWORD,CONTEXT **,DWORD *);
-WINBASEAPI BOOL        WINAPI InitializeContext2(void *,DWORD,CONTEXT **,DWORD *,ULONG64);
 WINBASEAPI void        WINAPI InitializeCriticalSection(CRITICAL_SECTION *lpCrit);
 WINBASEAPI BOOL        WINAPI InitializeCriticalSectionAndSpinCount(CRITICAL_SECTION *,DWORD);
 WINBASEAPI BOOL        WINAPI InitializeCriticalSectionEx(CRITICAL_SECTION *,DWORD,DWORD);
@@ -2441,7 +2428,6 @@
 WINBASEAPI SIZE_T      WINAPI LocalShrink(HGLOBAL,UINT);
 WINBASEAPI SIZE_T      WINAPI LocalSize(HLOCAL);
 WINBASEAPI BOOL        WINAPI LocalUnlock(HLOCAL);
-WINBASEAPI void *      WINAPI LocateXStateFeature(CONTEXT *,DWORD,DWORD *);
 WINBASEAPI LPVOID      WINAPI LockResource(HGLOBAL);
 #define                       LockSegment(handle) GlobalFix((HANDLE)(handle))
 WINADVAPI  BOOL        WINAPI LookupAccountNameA(LPCSTR,LPCSTR,PSID,LPDWORD,LPSTR,LPDWORD,PSID_NAME_USE);
@@ -2683,7 +2669,6 @@
 WINBASEAPI DWORD       WINAPI SetTapeParameters(HANDLE,DWORD,LPVOID);
 WINBASEAPI DWORD       WINAPI SetTapePosition(HANDLE,DWORD,DWORD,DWORD,DWORD,BOOL);
 WINBASEAPI DWORD_PTR   WINAPI SetThreadAffinityMask(HANDLE,DWORD_PTR);
-WINBASEAPI BOOL        WINAPI SetThreadContext(HANDLE,const CONTEXT *);
 WINBASEAPI BOOL        WINAPI SetThreadErrorMode(DWORD,LPDWORD);
 WINBASEAPI DWORD       WINAPI SetThreadExecutionState(EXECUTION_STATE);
 WINBASEAPI DWORD       WINAPI SetThreadIdealProcessor(HANDLE,DWORD);
@@ -2692,7 +2677,6 @@
 WINADVAPI  BOOL        WINAPI SetThreadToken(PHANDLE,HANDLE);
 WINBASEAPI HANDLE      WINAPI SetTimerQueueTimer(HANDLE,WAITORTIMERCALLBACK,PVOID,DWORD,DWORD,BOOL);
 WINADVAPI  BOOL        WINAPI SetTokenInformation(HANDLE,TOKEN_INFORMATION_CLASS,LPVOID,DWORD);
-WINBASEAPI LPTOP_LEVEL_EXCEPTION_FILTER WINAPI SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER);
 WINBASEAPI BOOL        WINAPI SetVolumeLabelA(LPCSTR,LPCSTR);
 WINBASEAPI BOOL        WINAPI SetVolumeLabelW(LPCWSTR,LPCWSTR);
 #define                       SetVolumeLabel WINELIB_NAME_AW(SetVolumeLabel)
@@ -2702,7 +2686,6 @@
 WINBASEAPI BOOL        WINAPI SetWaitableTimer(HANDLE,const LARGE_INTEGER*,LONG,PTIMERAPCROUTINE,LPVOID,BOOL);
 WINBASEAPI BOOL        WINAPI SetWaitableTimerEx(HANDLE,const LARGE_INTEGER*,LONG,PTIMERAPCROUTINE,LPVOID,REASON_CONTEXT*,ULONG);
 WINBASEAPI BOOL        WINAPI SetUmsThreadInformation(PUMS_CONTEXT,UMS_THREAD_INFO_CLASS,void *,ULONG);
-WINBASEAPI BOOL        WINAPI SetXStateFeaturesMask(CONTEXT*, DWORD64);
 WINBASEAPI BOOL        WINAPI SetupComm(HANDLE,DWORD,DWORD);
 WINBASEAPI DWORD       WINAPI SignalObjectAndWait(HANDLE,HANDLE,DWORD,BOOL);
 WINBASEAPI DWORD       WINAPI SizeofResource(HMODULE,HRSRC);
--- a/mingw-w64-tools/widl/include/winnt.h
+++ b/mingw-w64-tools/widl/include/winnt.h
@@ -952,89 +952,6 @@
                                                        struct _CONTEXT*,PVOID);
 typedef EXCEPTION_ROUTINE *PEXCEPTION_ROUTINE;
 
-/* The Win32 register context */
-
-/* i386 context definitions */
-#ifdef __i386__
-
-#define SIZE_OF_80387_REGISTERS      80
-
-typedef struct _FLOATING_SAVE_AREA
-{
-    DWORD   ControlWord;
-    DWORD   StatusWord;
-    DWORD   TagWord;
-    DWORD   ErrorOffset;
-    DWORD   ErrorSelector;
-    DWORD   DataOffset;
-    DWORD   DataSelector;
-    BYTE    RegisterArea[SIZE_OF_80387_REGISTERS];
-    DWORD   Cr0NpxState;
-} FLOATING_SAVE_AREA, *PFLOATING_SAVE_AREA;
-
-#define MAXIMUM_SUPPORTED_EXTENSION     512
-
-typedef struct _CONTEXT
-{
-    DWORD   ContextFlags;  /* 000 */
-
-    /* These are selected by CONTEXT_DEBUG_REGISTERS */
-    DWORD   Dr0;           /* 004 */
-    DWORD   Dr1;           /* 008 */
-    DWORD   Dr2;           /* 00c */
-    DWORD   Dr3;           /* 010 */
-    DWORD   Dr6;           /* 014 */
-    DWORD   Dr7;           /* 018 */
-
-    /* These are selected by CONTEXT_FLOATING_POINT */
-    FLOATING_SAVE_AREA FloatSave; /* 01c */
-
-    /* These are selected by CONTEXT_SEGMENTS */
-    DWORD   SegGs;         /* 08c */
-    DWORD   SegFs;         /* 090 */
-    DWORD   SegEs;         /* 094 */
-    DWORD   SegDs;         /* 098 */
-
-    /* These are selected by CONTEXT_INTEGER */
-    DWORD   Edi;           /* 09c */
-    DWORD   Esi;           /* 0a0 */
-    DWORD   Ebx;           /* 0a4 */
-    DWORD   Edx;           /* 0a8 */
-    DWORD   Ecx;           /* 0ac */
-    DWORD   Eax;           /* 0b0 */
-
-    /* These are selected by CONTEXT_CONTROL */
-    DWORD   Ebp;           /* 0b4 */
-    DWORD   Eip;           /* 0b8 */
-    DWORD   SegCs;         /* 0bc */
-    DWORD   EFlags;        /* 0c0 */
-    DWORD   Esp;           /* 0c4 */
-    DWORD   SegSs;         /* 0c8 */
-
-    BYTE    ExtendedRegisters[MAXIMUM_SUPPORTED_EXTENSION];  /* 0xcc */
-} CONTEXT, *PCONTEXT;
-
-#define CONTEXT_X86       0x00010000
-#define CONTEXT_i386      CONTEXT_X86
-#define CONTEXT_i486      CONTEXT_X86
-
-#define CONTEXT_CONTROL   (CONTEXT_i386 | 0x0001) /* SS:SP, CS:IP, FLAGS, BP */
-#define CONTEXT_INTEGER   (CONTEXT_i386 | 0x0002) /* AX, BX, CX, DX, SI, DI */
-#define CONTEXT_SEGMENTS  (CONTEXT_i386 | 0x0004) /* DS, ES, FS, GS */
-#define CONTEXT_FLOATING_POINT  (CONTEXT_i386 | 0x0008) /* 387 state */
-#define CONTEXT_DEBUG_REGISTERS (CONTEXT_i386 | 0x0010) /* DB 0-3,6,7 */
-#define CONTEXT_EXTENDED_REGISTERS (CONTEXT_i386 | 0x0020)
-#define CONTEXT_XSTATE             (CONTEXT_i386 | 0x0040)
-#define CONTEXT_FULL (CONTEXT_CONTROL | CONTEXT_INTEGER | CONTEXT_SEGMENTS)
-#define CONTEXT_ALL (CONTEXT_CONTROL | CONTEXT_INTEGER | CONTEXT_SEGMENTS | \
-        CONTEXT_FLOATING_POINT | CONTEXT_DEBUG_REGISTERS | CONTEXT_EXTENDED_REGISTERS)
-
-#define EXCEPTION_READ_FAULT    0
-#define EXCEPTION_WRITE_FAULT   1
-#define EXCEPTION_EXECUTE_FAULT 8
-
-#endif  /* __i386__ */
-
 typedef struct _LDT_ENTRY {
     WORD	LimitLow;
     WORD	BaseLow;
@@ -1084,1263 +1001,6 @@
     BYTE Reserved4[96];      /* 1a0 */
 } XSAVE_FORMAT, *PXSAVE_FORMAT;
 
-/* x86-64 context definitions */
-#if defined(__x86_64__)
-
-#define CONTEXT_AMD64   0x00100000
-
-#define CONTEXT_CONTROL   (CONTEXT_AMD64 | 0x0001)
-#define CONTEXT_INTEGER   (CONTEXT_AMD64 | 0x0002)
-#define CONTEXT_SEGMENTS  (CONTEXT_AMD64 | 0x0004)
-#define CONTEXT_FLOATING_POINT  (CONTEXT_AMD64 | 0x0008)
-#define CONTEXT_DEBUG_REGISTERS (CONTEXT_AMD64 | 0x0010)
-#define CONTEXT_XSTATE          (CONTEXT_AMD64 | 0x0040)
-#define CONTEXT_FULL (CONTEXT_CONTROL | CONTEXT_INTEGER | CONTEXT_FLOATING_POINT)
-#define CONTEXT_ALL (CONTEXT_CONTROL | CONTEXT_INTEGER | CONTEXT_SEGMENTS | CONTEXT_FLOATING_POINT | CONTEXT_DEBUG_REGISTERS)
-
-#define EXCEPTION_READ_FAULT    0
-#define EXCEPTION_WRITE_FAULT   1
-#define EXCEPTION_EXECUTE_FAULT 8
-
-typedef XSAVE_FORMAT XMM_SAVE_AREA32, *PXMM_SAVE_AREA32;
-
-typedef struct DECLSPEC_ALIGN(16) _CONTEXT {
-    DWORD64 P1Home;          /* 000 */
-    DWORD64 P2Home;          /* 008 */
-    DWORD64 P3Home;          /* 010 */
-    DWORD64 P4Home;          /* 018 */
-    DWORD64 P5Home;          /* 020 */
-    DWORD64 P6Home;          /* 028 */
-
-    /* Control flags */
-    DWORD ContextFlags;      /* 030 */
-    DWORD MxCsr;             /* 034 */
-
-    /* Segment */
-    WORD SegCs;              /* 038 */
-    WORD SegDs;              /* 03a */
-    WORD SegEs;              /* 03c */
-    WORD SegFs;              /* 03e */
-    WORD SegGs;              /* 040 */
-    WORD SegSs;              /* 042 */
-    DWORD EFlags;            /* 044 */
-
-    /* Debug */
-    DWORD64 Dr0;             /* 048 */
-    DWORD64 Dr1;             /* 050 */
-    DWORD64 Dr2;             /* 058 */
-    DWORD64 Dr3;             /* 060 */
-    DWORD64 Dr6;             /* 068 */
-    DWORD64 Dr7;             /* 070 */
-
-    /* Integer */
-    DWORD64 Rax;             /* 078 */
-    DWORD64 Rcx;             /* 080 */
-    DWORD64 Rdx;             /* 088 */
-    DWORD64 Rbx;             /* 090 */
-    DWORD64 Rsp;             /* 098 */
-    DWORD64 Rbp;             /* 0a0 */
-    DWORD64 Rsi;             /* 0a8 */
-    DWORD64 Rdi;             /* 0b0 */
-    DWORD64 R8;              /* 0b8 */
-    DWORD64 R9;              /* 0c0 */
-    DWORD64 R10;             /* 0c8 */
-    DWORD64 R11;             /* 0d0 */
-    DWORD64 R12;             /* 0d8 */
-    DWORD64 R13;             /* 0e0 */
-    DWORD64 R14;             /* 0e8 */
-    DWORD64 R15;             /* 0f0 */
-
-    /* Counter */
-    DWORD64 Rip;             /* 0f8 */
-
-    /* Floating point */
-    union {
-        XMM_SAVE_AREA32 FltSave;  /* 100 */
-        struct {
-            M128A Header[2];      /* 100 */
-            M128A Legacy[8];      /* 120 */
-            M128A Xmm0;           /* 1a0 */
-            M128A Xmm1;           /* 1b0 */
-            M128A Xmm2;           /* 1c0 */
-            M128A Xmm3;           /* 1d0 */
-            M128A Xmm4;           /* 1e0 */
-            M128A Xmm5;           /* 1f0 */
-            M128A Xmm6;           /* 200 */
-            M128A Xmm7;           /* 210 */
-            M128A Xmm8;           /* 220 */
-            M128A Xmm9;           /* 230 */
-            M128A Xmm10;          /* 240 */
-            M128A Xmm11;          /* 250 */
-            M128A Xmm12;          /* 260 */
-            M128A Xmm13;          /* 270 */
-            M128A Xmm14;          /* 280 */
-            M128A Xmm15;          /* 290 */
-        } DUMMYSTRUCTNAME;
-    } DUMMYUNIONNAME;
-
-    /* Vector */
-    M128A VectorRegister[26];     /* 300 */
-    DWORD64 VectorControl;        /* 4a0 */
-
-    /* Debug control */
-    DWORD64 DebugControl;         /* 4a8 */
-    DWORD64 LastBranchToRip;      /* 4b0 */
-    DWORD64 LastBranchFromRip;    /* 4b8 */
-    DWORD64 LastExceptionToRip;   /* 4c0 */
-    DWORD64 LastExceptionFromRip; /* 4c8 */
-} CONTEXT, *PCONTEXT;
-
-typedef struct _RUNTIME_FUNCTION
-{
-    DWORD BeginAddress;
-    DWORD EndAddress;
-    DWORD UnwindData;
-} RUNTIME_FUNCTION, *PRUNTIME_FUNCTION;
-
-#define UNWIND_HISTORY_TABLE_SIZE 12
-
-typedef struct _UNWIND_HISTORY_TABLE_ENTRY
-{
-    ULONG64 ImageBase;
-    PRUNTIME_FUNCTION FunctionEntry;
-} UNWIND_HISTORY_TABLE_ENTRY, *PUNWIND_HISTORY_TABLE_ENTRY;
-
-#define UNWIND_HISTORY_TABLE_NONE 0
-#define UNWIND_HISTORY_TABLE_GLOBAL 1
-#define UNWIND_HISTORY_TABLE_LOCAL 2
-
-typedef struct _UNWIND_HISTORY_TABLE
-{
-    ULONG Count;
-    UCHAR Search;
-    ULONG64 LowAddress;
-    ULONG64 HighAddress;
-    UNWIND_HISTORY_TABLE_ENTRY Entry[UNWIND_HISTORY_TABLE_SIZE];
-} UNWIND_HISTORY_TABLE, *PUNWIND_HISTORY_TABLE;
-
-typedef struct _KNONVOLATILE_CONTEXT_POINTERS
-{
-    union
-    {
-        PM128A FloatingContext[16];
-        struct
-        {
-            PM128A Xmm0;
-            PM128A Xmm1;
-            PM128A Xmm2;
-            PM128A Xmm3;
-            PM128A Xmm4;
-            PM128A Xmm5;
-            PM128A Xmm6;
-            PM128A Xmm7;
-            PM128A Xmm8;
-            PM128A Xmm9;
-            PM128A Xmm10;
-            PM128A Xmm11;
-            PM128A Xmm12;
-            PM128A Xmm13;
-            PM128A Xmm14;
-            PM128A Xmm15;
-        } DUMMYSTRUCTNAME;
-    } DUMMYUNIONNAME;
-
-    union
-    {
-        PULONG64 IntegerContext[16];
-        struct
-        {
-            PULONG64 Rax;
-            PULONG64 Rcx;
-            PULONG64 Rdx;
-            PULONG64 Rbx;
-            PULONG64 Rsp;
-            PULONG64 Rbp;
-            PULONG64 Rsi;
-            PULONG64 Rdi;
-            PULONG64 R8;
-            PULONG64 R9;
-            PULONG64 R10;
-            PULONG64 R11;
-            PULONG64 R12;
-            PULONG64 R13;
-            PULONG64 R14;
-            PULONG64 R15;
-        } DUMMYSTRUCTNAME;
-    } DUMMYUNIONNAME2;
-} KNONVOLATILE_CONTEXT_POINTERS, *PKNONVOLATILE_CONTEXT_POINTERS;
-
-typedef struct _DISPATCHER_CONTEXT
-{
-    ULONG64               ControlPc;
-    ULONG64               ImageBase;
-    PRUNTIME_FUNCTION     FunctionEntry;
-    ULONG64               EstablisherFrame;
-    ULONG64               TargetIp;
-    PCONTEXT              ContextRecord;
-    PEXCEPTION_ROUTINE    LanguageHandler;
-    PVOID                 HandlerData;
-    PUNWIND_HISTORY_TABLE HistoryTable;
-    DWORD                 ScopeIndex;
-    DWORD                 Fill0;
-} DISPATCHER_CONTEXT, *PDISPATCHER_CONTEXT;
-
-typedef LONG (CALLBACK *PEXCEPTION_FILTER)(struct _EXCEPTION_POINTERS*,PVOID);
-typedef void (CALLBACK *PTERMINATION_HANDLER)(BOOLEAN,PVOID);
-
-NTSYSAPI PVOID WINAPI RtlVirtualUnwind(ULONG,ULONG64,ULONG64,RUNTIME_FUNCTION*,CONTEXT*,PVOID*,ULONG64*,KNONVOLATILE_CONTEXT_POINTERS*);
-
-#define UNW_FLAG_NHANDLER  0
-#define UNW_FLAG_EHANDLER  1
-#define UNW_FLAG_UHANDLER  2
-#define UNW_FLAG_CHAININFO 4
-
-#endif /* __x86_64__ */
-
-#define XSTATE_LEGACY_FLOATING_POINT 0
-#define XSTATE_LEGACY_SSE            1
-#define XSTATE_GSSE                  2
-#define XSTATE_AVX                   XSTATE_GSSE
-#define XSTATE_MPX_BNDREGS           3
-#define XSTATE_MPX_BNDCSR            4
-#define XSTATE_AVX512_KMASK          5
-#define XSTATE_AVX512_ZMM_H          6
-#define XSTATE_AVX512_ZMM            7
-#define XSTATE_IPT                   8
-#define XSTATE_CET_U                 11
-#define XSTATE_LWP                   62
-
-typedef struct _YMMCONTEXT
-{
-    M128A Ymm0;
-    M128A Ymm1;
-    M128A Ymm2;
-    M128A Ymm3;
-    M128A Ymm4;
-    M128A Ymm5;
-    M128A Ymm6;
-    M128A Ymm7;
-    M128A Ymm8;
-    M128A Ymm9;
-    M128A Ymm10;
-    M128A Ymm11;
-    M128A Ymm12;
-    M128A Ymm13;
-    M128A Ymm14;
-    M128A Ymm15;
-}
-YMMCONTEXT, *PYMMCONTEXT;
-
-typedef struct _XSTATE
-{
-    ULONG64 Mask;
-    ULONG64 CompactionMask;
-    ULONG64 Reserved[6];
-    YMMCONTEXT YmmContext;
-} XSTATE, *PXSTATE;
-
-typedef struct _CONTEXT_CHUNK
-{
-    LONG Offset;
-    ULONG Length;
-} CONTEXT_CHUNK, *PCONTEXT_CHUNK;
-
-typedef struct _CONTEXT_EX
-{
-    CONTEXT_CHUNK All;
-    CONTEXT_CHUNK Legacy;
-    CONTEXT_CHUNK XState;
-#ifdef _WIN64
-    ULONG64 align;
-#endif
-} CONTEXT_EX, *PCONTEXT_EX;
-
-/* IA64 context definitions */
-#ifdef __ia64__
-
-#define CONTEXT_IA64                  0x00080000
-#define CONTEXT_CONTROL               (CONTEXT_IA64 | 0x00000001)
-#define CONTEXT_LOWER_FLOATING_POINT  (CONTEXT_IA64 | 0x00000002)
-#define CONTEXT_HIGHER_FLOATING_POINT (CONTEXT_IA64 | 0x00000004)
-#define CONTEXT_INTEGER               (CONTEXT_IA64 | 0x00000008)
-#define CONTEXT_DEBUG                 (CONTEXT_IA64 | 0x00000010)
-#define CONTEXT_IA32_CONTROL          (CONTEXT_IA64 | 0x00000020)
-#define CONTEXT_FLOATING_POINT        (CONTEXT_LOWER_FLOATING_POINT | CONTEXT_HIGHER_FLOATING_POINT)
-#define CONTEXT_FULL                  (CONTEXT_CONTROL | CONTEXT_FLOATING_POINT | CONTEXT_INTEGER | CONTEXT_IA32_CONTROL)
-#define CONTEXT_ALL                   (CONTEXT_CONTROL | CONTEXT_FLOATING_POINT | CONTEXT_INTEGER | CONTEXT_DEBUG | CONTEXT_IA32_CONTROL)
-
-#define CONTEXT_EXCEPTION_ACTIVE      0x8000000
-#define CONTEXT_SERVICE_ACTIVE        0x10000000
-#define CONTEXT_EXCEPTION_REQUEST     0x40000000
-#define CONTEXT_EXCEPTION_REPORTING   0x80000000
-
-typedef struct _CONTEXT
-{
-    DWORD ContextFlags;
-    DWORD Fill1[3];
-    ULONGLONG DbI0;
-    ULONGLONG DbI1;
-    ULONGLONG DbI2;
-    ULONGLONG DbI3;
-    ULONGLONG DbI4;
-    ULONGLONG DbI5;
-    ULONGLONG DbI6;
-    ULONGLONG DbI7;
-    ULONGLONG DbD0;
-    ULONGLONG DbD1;
-    ULONGLONG DbD2;
-    ULONGLONG DbD3;
-    ULONGLONG DbD4;
-    ULONGLONG DbD5;
-    ULONGLONG DbD6;
-    ULONGLONG DbD7;
-    FLOAT128 FltS0;
-    FLOAT128 FltS1;
-    FLOAT128 FltS2;
-    FLOAT128 FltS3;
-    FLOAT128 FltT0;
-    FLOAT128 FltT1;
-    FLOAT128 FltT2;
-    FLOAT128 FltT3;
-    FLOAT128 FltT4;
-    FLOAT128 FltT5;
-    FLOAT128 FltT6;
-    FLOAT128 FltT7;
-    FLOAT128 FltT8;
-    FLOAT128 FltT9;
-    FLOAT128 FltS4;
-    FLOAT128 FltS5;
-    FLOAT128 FltS6;
-    FLOAT128 FltS7;
-    FLOAT128 FltS8;
-    FLOAT128 FltS9;
-    FLOAT128 FltS10;
-    FLOAT128 FltS11;
-    FLOAT128 FltS12;
-    FLOAT128 FltS13;
-    FLOAT128 FltS14;
-    FLOAT128 FltS15;
-    FLOAT128 FltS16;
-    FLOAT128 FltS17;
-    FLOAT128 FltS18;
-    FLOAT128 FltS19;
-    FLOAT128 FltF32;
-    FLOAT128 FltF33;
-    FLOAT128 FltF34;
-    FLOAT128 FltF35;
-    FLOAT128 FltF36;
-    FLOAT128 FltF37;
-    FLOAT128 FltF38;
-    FLOAT128 FltF39;
-    FLOAT128 FltF40;
-    FLOAT128 FltF41;
-    FLOAT128 FltF42;
-    FLOAT128 FltF43;
-    FLOAT128 FltF44;
-    FLOAT128 FltF45;
-    FLOAT128 FltF46;
-    FLOAT128 FltF47;
-    FLOAT128 FltF48;
-    FLOAT128 FltF49;
-    FLOAT128 FltF50;
-    FLOAT128 FltF51;
-    FLOAT128 FltF52;
-    FLOAT128 FltF53;
-    FLOAT128 FltF54;
-    FLOAT128 FltF55;
-    FLOAT128 FltF56;
-    FLOAT128 FltF57;
-    FLOAT128 FltF58;
-    FLOAT128 FltF59;
-    FLOAT128 FltF60;
-    FLOAT128 FltF61;
-    FLOAT128 FltF62;
-    FLOAT128 FltF63;
-    FLOAT128 FltF64;
-    FLOAT128 FltF65;
-    FLOAT128 FltF66;
-    FLOAT128 FltF67;
-    FLOAT128 FltF68;
-    FLOAT128 FltF69;
-    FLOAT128 FltF70;
-    FLOAT128 FltF71;
-    FLOAT128 FltF72;
-    FLOAT128 FltF73;
-    FLOAT128 FltF74;
-    FLOAT128 FltF75;
-    FLOAT128 FltF76;
-    FLOAT128 FltF77;
-    FLOAT128 FltF78;
-    FLOAT128 FltF79;
-    FLOAT128 FltF80;
-    FLOAT128 FltF81;
-    FLOAT128 FltF82;
-    FLOAT128 FltF83;
-    FLOAT128 FltF84;
-    FLOAT128 FltF85;
-    FLOAT128 FltF86;
-    FLOAT128 FltF87;
-    FLOAT128 FltF88;
-    FLOAT128 FltF89;
-    FLOAT128 FltF90;
-    FLOAT128 FltF91;
-    FLOAT128 FltF92;
-    FLOAT128 FltF93;
-    FLOAT128 FltF94;
-    FLOAT128 FltF95;
-    FLOAT128 FltF96;
-    FLOAT128 FltF97;
-    FLOAT128 FltF98;
-    FLOAT128 FltF99;
-    FLOAT128 FltF100;
-    FLOAT128 FltF101;
-    FLOAT128 FltF102;
-    FLOAT128 FltF103;
-    FLOAT128 FltF104;
-    FLOAT128 FltF105;
-    FLOAT128 FltF106;
-    FLOAT128 FltF107;
-    FLOAT128 FltF108;
-    FLOAT128 FltF109;
-    FLOAT128 FltF110;
-    FLOAT128 FltF111;
-    FLOAT128 FltF112;
-    FLOAT128 FltF113;
-    FLOAT128 FltF114;
-    FLOAT128 FltF115;
-    FLOAT128 FltF116;
-    FLOAT128 FltF117;
-    FLOAT128 FltF118;
-    FLOAT128 FltF119;
-    FLOAT128 FltF120;
-    FLOAT128 FltF121;
-    FLOAT128 FltF122;
-    FLOAT128 FltF123;
-    FLOAT128 FltF124;
-    FLOAT128 FltF125;
-    FLOAT128 FltF126;
-    FLOAT128 FltF127;
-    ULONGLONG StFPSR;
-    ULONGLONG IntGp;
-    ULONGLONG IntT0;
-    ULONGLONG IntT1;
-    ULONGLONG IntS0;
-    ULONGLONG IntS1;
-    ULONGLONG IntS2;
-    ULONGLONG IntS3;
-    ULONGLONG IntV0;
-    ULONGLONG IntT2;
-    ULONGLONG IntT3;
-    ULONGLONG IntT4;
-    ULONGLONG IntSp;
-    ULONGLONG IntTeb;
-    ULONGLONG IntT5;
-    ULONGLONG IntT6;
-    ULONGLONG IntT7;
-    ULONGLONG IntT8;
-    ULONGLONG IntT9;
-    ULONGLONG IntT10;
-    ULONGLONG IntT11;
-    ULONGLONG IntT12;
-    ULONGLONG IntT13;
-    ULONGLONG IntT14;
-    ULONGLONG IntT15;
-    ULONGLONG IntT16;
-    ULONGLONG IntT17;
-    ULONGLONG IntT18;
-    ULONGLONG IntT19;
-    ULONGLONG IntT20;
-    ULONGLONG IntT21;
-    ULONGLONG IntT22;
-    ULONGLONG IntNats;
-    ULONGLONG Preds;
-    ULONGLONG BrRp;
-    ULONGLONG BrS0;
-    ULONGLONG BrS1;
-    ULONGLONG BrS2;
-    ULONGLONG BrS3;
-    ULONGLONG BrS4;
-    ULONGLONG BrT0;
-    ULONGLONG BrT1;
-    ULONGLONG ApUNAT;
-    ULONGLONG ApLC;
-    ULONGLONG ApEC;
-    ULONGLONG ApCCV;
-    ULONGLONG ApDCR;
-    ULONGLONG RsPFS;
-    ULONGLONG RsBSP;
-    ULONGLONG RsBSPSTORE;
-    ULONGLONG RsRSC;
-    ULONGLONG RsRNAT;
-    ULONGLONG StIPSR;
-    ULONGLONG StIIP;
-    ULONGLONG StIFS;
-    ULONGLONG StFCR;
-    ULONGLONG Eflag;
-    ULONGLONG SegCSD;
-    ULONGLONG SegSSD;
-    ULONGLONG Cflag;
-    ULONGLONG StFSR;
-    ULONGLONG StFIR;
-    ULONGLONG StFDR;
-    ULONGLONG UNUSEDPACK;
-} CONTEXT, *PCONTEXT;
-
-typedef struct _RUNTIME_FUNCTION
-{
-    ULONG BeginAddress;
-    ULONG EndAddress;
-    ULONG UnwindInfoAddress;
-} RUNTIME_FUNCTION, *PRUNTIME_FUNCTION;
-
-typedef struct _FRAME_POINTERS {
-  ULONGLONG MemoryStackFp;
-  ULONGLONG BackingStoreFp;
-} FRAME_POINTERS, *PFRAME_POINTERS;
-
-#define UNWIND_HISTORY_TABLE_SIZE 12
-
-typedef struct _UNWIND_HISTORY_TABLE_ENTRY {
-  ULONG64 ImageBase;
-  ULONG64 Gp;
-  PRUNTIME_FUNCTION FunctionEntry;
-} UNWIND_HISTORY_TABLE_ENTRY, *PUNWIND_HISTORY_TABLE_ENTRY;
-
-typedef struct _UNWIND_HISTORY_TABLE {
-  ULONG Count;
-  UCHAR Search;
-  ULONG64 LowAddress;
-  ULONG64 HighAddress;
-  UNWIND_HISTORY_TABLE_ENTRY Entry[UNWIND_HISTORY_TABLE_SIZE];
-} UNWIND_HISTORY_TABLE, *PUNWIND_HISTORY_TABLE;
-
-typedef struct _KNONVOLATILE_CONTEXT_POINTERS
-{
-    PFLOAT128  FltS0;
-    PFLOAT128  FltS1;
-    PFLOAT128  FltS2;
-    PFLOAT128  FltS3;
-    PFLOAT128  HighFloatingContext[10];
-    PFLOAT128  FltS4;
-    PFLOAT128  FltS5;
-    PFLOAT128  FltS6;
-    PFLOAT128  FltS7;
-    PFLOAT128  FltS8;
-    PFLOAT128  FltS9;
-    PFLOAT128  FltS10;
-    PFLOAT128  FltS11;
-    PFLOAT128  FltS12;
-    PFLOAT128  FltS13;
-    PFLOAT128  FltS14;
-    PFLOAT128  FltS15;
-    PFLOAT128  FltS16;
-    PFLOAT128  FltS17;
-    PFLOAT128  FltS18;
-    PFLOAT128  FltS19;
-    PULONGLONG IntS0;
-    PULONGLONG IntS1;
-    PULONGLONG IntS2;
-    PULONGLONG IntS3;
-    PULONGLONG IntSp;
-    PULONGLONG IntS0Nat;
-    PULONGLONG IntS1Nat;
-    PULONGLONG IntS2Nat;
-    PULONGLONG IntS3Nat;
-    PULONGLONG IntSpNat;
-    PULONGLONG Preds;
-    PULONGLONG BrRp;
-    PULONGLONG BrS0;
-    PULONGLONG BrS1;
-    PULONGLONG BrS2;
-    PULONGLONG BrS3;
-    PULONGLONG BrS4;
-    PULONGLONG ApUNAT;
-    PULONGLONG ApLC;
-    PULONGLONG ApEC;
-    PULONGLONG RsPFS;
-    PULONGLONG StFSR;
-    PULONGLONG StFIR;
-    PULONGLONG StFDR;
-    PULONGLONG Cflag;
-} KNONVOLATILE_CONTEXT_POINTERS, *PKNONVOLATILE_CONTEXT_POINTERS;
-
-NTSYSAPI ULONGLONG WINAPI RtlVirtualUnwind(ULONGLONG,ULONGLONG,RUNTIME_FUNCTION*,CONTEXT*,BOOLEAN*,FRAME_POINTERS*,KNONVOLATILE_CONTEXT_POINTERS*);
-
-#endif /* __ia64__ */
-
-/* Alpha context definitions */
-#if defined(_ALPHA_) || defined(__ALPHA__) || defined(__alpha__)
-
-#define CONTEXT_ALPHA   0x00020000
-
-#define CONTEXT_CONTROL         (CONTEXT_ALPHA | 0x00000001)
-#define CONTEXT_FLOATING_POINT  (CONTEXT_ALPHA | 0x00000002)
-#define CONTEXT_INTEGER         (CONTEXT_ALPHA | 0x00000004)
-#define CONTEXT_FULL  (CONTEXT_CONTROL | CONTEXT_FLOATING_POINT | CONTEXT_INTEGER)
-
-#define EXCEPTION_READ_FAULT    0
-#define EXCEPTION_WRITE_FAULT   1
-#define EXCEPTION_EXECUTE_FAULT 8
-
-typedef struct _CONTEXT
-{
-    /* selected by CONTEXT_FLOATING_POINT */
-    ULONGLONG FltF0;
-    ULONGLONG FltF1;
-    ULONGLONG FltF2;
-    ULONGLONG FltF3;
-    ULONGLONG FltF4;
-    ULONGLONG FltF5;
-    ULONGLONG FltF6;
-    ULONGLONG FltF7;
-    ULONGLONG FltF8;
-    ULONGLONG FltF9;
-    ULONGLONG FltF10;
-    ULONGLONG FltF11;
-    ULONGLONG FltF12;
-    ULONGLONG FltF13;
-    ULONGLONG FltF14;
-    ULONGLONG FltF15;
-    ULONGLONG FltF16;
-    ULONGLONG FltF17;
-    ULONGLONG FltF18;
-    ULONGLONG FltF19;
-    ULONGLONG FltF20;
-    ULONGLONG FltF21;
-    ULONGLONG FltF22;
-    ULONGLONG FltF23;
-    ULONGLONG FltF24;
-    ULONGLONG FltF25;
-    ULONGLONG FltF26;
-    ULONGLONG FltF27;
-    ULONGLONG FltF28;
-    ULONGLONG FltF29;
-    ULONGLONG FltF30;
-    ULONGLONG FltF31;
-
-    /* selected by CONTEXT_INTEGER */
-    ULONGLONG IntV0;
-    ULONGLONG IntT0;
-    ULONGLONG IntT1;
-    ULONGLONG IntT2;
-    ULONGLONG IntT3;
-    ULONGLONG IntT4;
-    ULONGLONG IntT5;
-    ULONGLONG IntT6;
-    ULONGLONG IntT7;
-    ULONGLONG IntS0;
-    ULONGLONG IntS1;
-    ULONGLONG IntS2;
-    ULONGLONG IntS3;
-    ULONGLONG IntS4;
-    ULONGLONG IntS5;
-    ULONGLONG IntFp;
-    ULONGLONG IntA0;
-    ULONGLONG IntA1;
-    ULONGLONG IntA2;
-    ULONGLONG IntA3;
-    ULONGLONG IntA4;
-    ULONGLONG IntA5;
-    ULONGLONG IntT8;
-    ULONGLONG IntT9;
-    ULONGLONG IntT10;
-    ULONGLONG IntT11;
-    ULONGLONG IntRa;
-    ULONGLONG IntT12;
-    ULONGLONG IntAt;
-    ULONGLONG IntGp;
-    ULONGLONG IntSp;
-    ULONGLONG IntZero;
-
-    /* selected by CONTEXT_FLOATING_POINT */
-    ULONGLONG Fpcr;
-    ULONGLONG SoftFpcr;
-
-    /* selected by CONTEXT_CONTROL */
-    ULONGLONG Fir;
-    DWORD Psr;
-    DWORD ContextFlags;
-    DWORD Fill[4];
-} CONTEXT, *PCONTEXT;
-
-#define _QUAD_PSR_OFFSET   HighSoftFpcr
-#define _QUAD_FLAGS_OFFSET HighFir
-
-#endif  /* _ALPHA_ */
-
-#ifdef __arm__
-
-/* The following flags control the contents of the CONTEXT structure. */
-
-#define CONTEXT_ARM    0x0200000
-#define CONTEXT_CONTROL         (CONTEXT_ARM | 0x00000001)
-#define CONTEXT_INTEGER         (CONTEXT_ARM | 0x00000002)
-#define CONTEXT_FLOATING_POINT  (CONTEXT_ARM | 0x00000004)
-#define CONTEXT_DEBUG_REGISTERS (CONTEXT_ARM | 0x00000008)
-
-#define CONTEXT_FULL (CONTEXT_CONTROL | CONTEXT_INTEGER)
-#define CONTEXT_ALL  (CONTEXT_CONTROL | CONTEXT_INTEGER | CONTEXT_FLOATING_POINT | CONTEXT_DEBUG_REGISTERS)
-
-#define EXCEPTION_READ_FAULT    0
-#define EXCEPTION_WRITE_FAULT   1
-#define EXCEPTION_EXECUTE_FAULT 8
-
-#define ARM_MAX_BREAKPOINTS     8
-#define ARM_MAX_WATCHPOINTS     1
-
-typedef struct _RUNTIME_FUNCTION
-{
-    DWORD BeginAddress;
-    union {
-        DWORD UnwindData;
-        struct {
-            DWORD Flag : 2;
-            DWORD FunctionLength : 11;
-            DWORD Ret : 2;
-            DWORD H : 1;
-            DWORD Reg : 3;
-            DWORD R : 1;
-            DWORD L : 1;
-            DWORD C : 1;
-            DWORD StackAdjust : 10;
-        } DUMMYSTRUCTNAME;
-    } DUMMYUNIONNAME;
-} RUNTIME_FUNCTION, *PRUNTIME_FUNCTION;
-
-#define UNWIND_HISTORY_TABLE_SIZE 12
-
-typedef struct _UNWIND_HISTORY_TABLE_ENTRY
-{
-    DWORD ImageBase;
-    PRUNTIME_FUNCTION FunctionEntry;
-} UNWIND_HISTORY_TABLE_ENTRY, *PUNWIND_HISTORY_TABLE_ENTRY;
-
-typedef struct _UNWIND_HISTORY_TABLE
-{
-    DWORD Count;
-    BYTE  LocalHint;
-    BYTE  GlobalHint;
-    BYTE  Search;
-    BYTE  Once;
-    DWORD LowAddress;
-    DWORD HighAddress;
-    UNWIND_HISTORY_TABLE_ENTRY Entry[UNWIND_HISTORY_TABLE_SIZE];
-} UNWIND_HISTORY_TABLE, *PUNWIND_HISTORY_TABLE;
-
-typedef struct _NEON128
-{
-    ULONGLONG Low;
-    LONGLONG High;
-} NEON128, *PNEON128;
-
-typedef struct _CONTEXT
-{
-    ULONG ContextFlags;             /* 000 */
-    /* CONTEXT_INTEGER */
-    ULONG R0;                       /* 004 */
-    ULONG R1;                       /* 008 */
-    ULONG R2;                       /* 00c */
-    ULONG R3;                       /* 010 */
-    ULONG R4;                       /* 014 */
-    ULONG R5;                       /* 018 */
-    ULONG R6;                       /* 01c */
-    ULONG R7;                       /* 020 */
-    ULONG R8;                       /* 024 */
-    ULONG R9;                       /* 028 */
-    ULONG R10;                      /* 02c */
-    ULONG R11;                      /* 030 */
-    ULONG R12;                      /* 034 */
-    /* CONTEXT_CONTROL */
-    ULONG Sp;                       /* 038 */
-    ULONG Lr;                       /* 03c */
-    ULONG Pc;                       /* 040 */
-    ULONG Cpsr;                     /* 044 */
-    /* CONTEXT_FLOATING_POINT */
-    ULONG Fpscr;                    /* 048 */
-    ULONG Padding;                  /* 04c */
-    union
-    {
-        NEON128 Q[16];
-        ULONGLONG D[32];
-        ULONG S[32];
-    } DUMMYUNIONNAME;               /* 050 */
-    /* CONTEXT_DEBUG_REGISTERS */
-    ULONG Bvr[ARM_MAX_BREAKPOINTS]; /* 150 */
-    ULONG Bcr[ARM_MAX_BREAKPOINTS]; /* 170 */
-    ULONG Wvr[ARM_MAX_WATCHPOINTS]; /* 190 */
-    ULONG Wcr[ARM_MAX_WATCHPOINTS]; /* 194 */
-    ULONG Padding2[2];              /* 198 */
-} CONTEXT, *PCONTEXT;
-
-typedef struct _KNONVOLATILE_CONTEXT_POINTERS
-{
-    PDWORD     R4;
-    PDWORD     R5;
-    PDWORD     R6;
-    PDWORD     R7;
-    PDWORD     R8;
-    PDWORD     R9;
-    PDWORD     R10;
-    PDWORD     R11;
-    PDWORD     Lr;
-    PULONGLONG D8;
-    PULONGLONG D9;
-    PULONGLONG D10;
-    PULONGLONG D11;
-    PULONGLONG D12;
-    PULONGLONG D13;
-    PULONGLONG D14;
-    PULONGLONG D15;
-} KNONVOLATILE_CONTEXT_POINTERS, *PKNONVOLATILE_CONTEXT_POINTERS;
-
-typedef struct _DISPATCHER_CONTEXT
-{
-    DWORD                 ControlPc;
-    DWORD                 ImageBase;
-    PRUNTIME_FUNCTION     FunctionEntry;
-    DWORD                 EstablisherFrame;
-    DWORD                 TargetPc;
-    PCONTEXT              ContextRecord;
-    PEXCEPTION_ROUTINE    LanguageHandler;
-    PVOID                 HandlerData;
-    PUNWIND_HISTORY_TABLE HistoryTable;
-    DWORD                 ScopeIndex;
-    BOOLEAN               ControlPcIsUnwound;
-    PBYTE                 NonVolatileRegisters;
-    DWORD                 Reserved;
-} DISPATCHER_CONTEXT, *PDISPATCHER_CONTEXT;
-
-typedef LONG (CALLBACK *PEXCEPTION_FILTER)(struct _EXCEPTION_POINTERS*,DWORD);
-typedef void (CALLBACK *PTERMINATION_HANDLER)(BOOLEAN,DWORD);
-
-NTSYSAPI PVOID WINAPI RtlVirtualUnwind(DWORD,DWORD,DWORD,RUNTIME_FUNCTION*,CONTEXT*,PVOID*,DWORD*,KNONVOLATILE_CONTEXT_POINTERS*);
-
-#define UNW_FLAG_NHANDLER  0
-#define UNW_FLAG_EHANDLER  1
-#define UNW_FLAG_UHANDLER  2
-
-#endif /* __arm__ */
-
-#ifdef __aarch64__
-
-#define CONTEXT_ARM64           0x400000
-#define CONTEXT_CONTROL         (CONTEXT_ARM64 | 0x00000001)
-#define CONTEXT_INTEGER         (CONTEXT_ARM64 | 0x00000002)
-#define CONTEXT_FLOATING_POINT  (CONTEXT_ARM64 | 0x00000004)
-#define CONTEXT_DEBUG_REGISTERS (CONTEXT_ARM64 | 0x00000008)
-#define CONTEXT_ARM64_X18       (CONTEXT_ARM64 | 0x00000010)
-
-#define CONTEXT_UNWOUND_TO_CALL 0x20000000
-
-#define CONTEXT_FULL (CONTEXT_CONTROL | CONTEXT_INTEGER | CONTEXT_FLOATING_POINT)
-#define CONTEXT_ALL  (CONTEXT_CONTROL | CONTEXT_INTEGER | CONTEXT_FLOATING_POINT | CONTEXT_DEBUG_REGISTERS | CONTEXT_ARM64_X18)
-
-#define EXCEPTION_READ_FAULT    0
-#define EXCEPTION_WRITE_FAULT   1
-#define EXCEPTION_EXECUTE_FAULT 8
-
-#define ARM64_MAX_BREAKPOINTS   8
-#define ARM64_MAX_WATCHPOINTS   2
-
-typedef struct _RUNTIME_FUNCTION
-{
-    DWORD BeginAddress;
-    union
-    {
-        DWORD UnwindData;
-        struct
-        {
-            DWORD Flag : 2;
-            DWORD FunctionLength : 11;
-            DWORD RegF : 3;
-            DWORD RegI : 4;
-            DWORD H : 1;
-            DWORD CR : 2;
-            DWORD FrameSize : 9;
-        } DUMMYSTRUCTNAME;
-    } DUMMYUNIONNAME;
-} RUNTIME_FUNCTION, *PRUNTIME_FUNCTION;
-
-#define UNWIND_HISTORY_TABLE_SIZE 12
-
-typedef struct _UNWIND_HISTORY_TABLE_ENTRY
-{
-    DWORD64 ImageBase;
-    PRUNTIME_FUNCTION FunctionEntry;
-} UNWIND_HISTORY_TABLE_ENTRY, *PUNWIND_HISTORY_TABLE_ENTRY;
-
-typedef struct _UNWIND_HISTORY_TABLE
-{
-    DWORD   Count;
-    BYTE    LocalHint;
-    BYTE    GlobalHint;
-    BYTE    Search;
-    BYTE    Once;
-    DWORD64 LowAddress;
-    DWORD64 HighAddress;
-    UNWIND_HISTORY_TABLE_ENTRY Entry[UNWIND_HISTORY_TABLE_SIZE];
-} UNWIND_HISTORY_TABLE, *PUNWIND_HISTORY_TABLE;
-
-typedef union _NEON128
-{
-    struct
-    {
-        ULONGLONG Low;
-        LONGLONG High;
-    } DUMMYSTRUCTNAME;
-    double D[2];
-    float S[4];
-    WORD  H[8];
-    BYTE  B[16];
-} NEON128, *PNEON128;
-
-typedef struct _CONTEXT
-{
-    ULONG ContextFlags;                 /* 000 */
-    /* CONTEXT_INTEGER */
-    ULONG Cpsr;                         /* 004 */
-    union
-    {
-        struct
-        {
-            DWORD64 X0;                 /* 008 */
-            DWORD64 X1;                 /* 010 */
-            DWORD64 X2;                 /* 018 */
-            DWORD64 X3;                 /* 020 */
-            DWORD64 X4;                 /* 028 */
-            DWORD64 X5;                 /* 030 */
-            DWORD64 X6;                 /* 038 */
-            DWORD64 X7;                 /* 040 */
-            DWORD64 X8;                 /* 048 */
-            DWORD64 X9;                 /* 050 */
-            DWORD64 X10;                /* 058 */
-            DWORD64 X11;                /* 060 */
-            DWORD64 X12;                /* 068 */
-            DWORD64 X13;                /* 070 */
-            DWORD64 X14;                /* 078 */
-            DWORD64 X15;                /* 080 */
-            DWORD64 X16;                /* 088 */
-            DWORD64 X17;                /* 090 */
-            DWORD64 X18;                /* 098 */
-            DWORD64 X19;                /* 0a0 */
-            DWORD64 X20;                /* 0a8 */
-            DWORD64 X21;                /* 0b0 */
-            DWORD64 X22;                /* 0b8 */
-            DWORD64 X23;                /* 0c0 */
-            DWORD64 X24;                /* 0c8 */
-            DWORD64 X25;                /* 0d0 */
-            DWORD64 X26;                /* 0d8 */
-            DWORD64 X27;                /* 0e0 */
-            DWORD64 X28;                /* 0e8 */
-            DWORD64 Fp;                 /* 0f0 */
-            DWORD64 Lr;                 /* 0f8 */
-        } DUMMYSTRUCTNAME;
-        DWORD64 X[31];                  /* 008 */
-    } DUMMYUNIONNAME;
-    /* CONTEXT_CONTROL */
-    DWORD64 Sp;                         /* 100 */
-    DWORD64 Pc;                         /* 108 */
-    /* CONTEXT_FLOATING_POINT */
-    NEON128 V[32];                      /* 110 */
-    DWORD Fpcr;                         /* 310 */
-    DWORD Fpsr;                         /* 314 */
-    /* CONTEXT_DEBUG_REGISTERS */
-    DWORD Bcr[ARM64_MAX_BREAKPOINTS];   /* 318 */
-    DWORD64 Bvr[ARM64_MAX_BREAKPOINTS]; /* 338 */
-    DWORD Wcr[ARM64_MAX_WATCHPOINTS];   /* 378 */
-    DWORD64 Wvr[ARM64_MAX_WATCHPOINTS]; /* 380 */
-} CONTEXT, *PCONTEXT;
-
-typedef struct _KNONVOLATILE_CONTEXT_POINTERS
-{
-    PDWORD64 X19;
-    PDWORD64 X20;
-    PDWORD64 X21;
-    PDWORD64 X22;
-    PDWORD64 X23;
-    PDWORD64 X24;
-    PDWORD64 X25;
-    PDWORD64 X26;
-    PDWORD64 X27;
-    PDWORD64 X28;
-    PDWORD64 Fp;
-    PDWORD64 Lr;
-    PDWORD64 D8;
-    PDWORD64 D9;
-    PDWORD64 D10;
-    PDWORD64 D11;
-    PDWORD64 D12;
-    PDWORD64 D13;
-    PDWORD64 D14;
-    PDWORD64 D15;
-} KNONVOLATILE_CONTEXT_POINTERS, *PKNONVOLATILE_CONTEXT_POINTERS;
-
-typedef struct _DISPATCHER_CONTEXT
-{
-    ULONG_PTR             ControlPc;
-    ULONG_PTR             ImageBase;
-    PRUNTIME_FUNCTION     FunctionEntry;
-    ULONG_PTR             EstablisherFrame;
-    ULONG_PTR             TargetPc;
-    PCONTEXT              ContextRecord;
-    PEXCEPTION_ROUTINE    LanguageHandler;
-    PVOID                 HandlerData;
-    PUNWIND_HISTORY_TABLE HistoryTable;
-    DWORD                 ScopeIndex;
-    BOOLEAN               ControlPcIsUnwound;
-    PBYTE                 NonVolatileRegisters;
-} DISPATCHER_CONTEXT, *PDISPATCHER_CONTEXT;
-
-typedef LONG (CALLBACK *PEXCEPTION_FILTER)(struct _EXCEPTION_POINTERS*,DWORD64);
-typedef void (CALLBACK *PTERMINATION_HANDLER)(BOOLEAN,DWORD64);
-
-NTSYSAPI PVOID WINAPI RtlVirtualUnwind(DWORD,ULONG_PTR,ULONG_PTR,RUNTIME_FUNCTION*,CONTEXT*,PVOID*,ULONG_PTR*,KNONVOLATILE_CONTEXT_POINTERS*);
-
-#define UNW_FLAG_NHANDLER  0
-#define UNW_FLAG_EHANDLER  1
-#define UNW_FLAG_UHANDLER  2
-
-#endif /* __aarch64__ */
-
-
-/* Mips context definitions */
-#if defined(_MIPS_) || defined(__MIPS__) || defined(__mips__)
-
-#define CONTEXT_R4000   0x00010000
-
-#define CONTEXT_CONTROL         (CONTEXT_R4000 | 0x00000001)
-#define CONTEXT_FLOATING_POINT  (CONTEXT_R4000 | 0x00000002)
-#define CONTEXT_INTEGER         (CONTEXT_R4000 | 0x00000004)
-
-#define CONTEXT_FULL (CONTEXT_CONTROL | CONTEXT_FLOATING_POINT | CONTEXT_INTEGER)
-
-#define EXCEPTION_READ_FAULT    0
-#define EXCEPTION_WRITE_FAULT   1
-#define EXCEPTION_EXECUTE_FAULT 8
-
-typedef struct _CONTEXT
-{
-    DWORD Argument[4];
-    /* These are selected by CONTEXT_FLOATING_POINT */
-    DWORD FltF0;
-    DWORD FltF1;
-    DWORD FltF2;
-    DWORD FltF3;
-    DWORD FltF4;
-    DWORD FltF5;
-    DWORD FltF6;
-    DWORD FltF7;
-    DWORD FltF8;
-    DWORD FltF9;
-    DWORD FltF10;
-    DWORD FltF11;
-    DWORD FltF12;
-    DWORD FltF13;
-    DWORD FltF14;
-    DWORD FltF15;
-    DWORD FltF16;
-    DWORD FltF17;
-    DWORD FltF18;
-    DWORD FltF19;
-    DWORD FltF20;
-    DWORD FltF21;
-    DWORD FltF22;
-    DWORD FltF23;
-    DWORD FltF24;
-    DWORD FltF25;
-    DWORD FltF26;
-    DWORD FltF27;
-    DWORD FltF28;
-    DWORD FltF29;
-    DWORD FltF30;
-    DWORD FltF31;
-
-    /* These are selected by CONTEXT_INTEGER */
-    DWORD IntZero;
-    DWORD IntAt;
-    DWORD IntV0;
-    DWORD IntV1;
-    DWORD IntA0;
-    DWORD IntA1;
-    DWORD IntA2;
-    DWORD IntA3;
-    DWORD IntT0;
-    DWORD IntT1;
-    DWORD IntT2;
-    DWORD IntT3;
-    DWORD IntT4;
-    DWORD IntT5;
-    DWORD IntT6;
-    DWORD IntT7;
-    DWORD IntS0;
-    DWORD IntS1;
-    DWORD IntS2;
-    DWORD IntS3;
-    DWORD IntS4;
-    DWORD IntS5;
-    DWORD IntS6;
-    DWORD IntS7;
-    DWORD IntT8;
-    DWORD IntT9;
-    DWORD IntK0;
-    DWORD IntK1;
-    DWORD IntGp;
-    DWORD IntSp;
-    DWORD IntS8;
-    DWORD IntRa;
-    DWORD IntLo;
-    DWORD IntHi;
-
-    /* These are selected by CONTEXT_FLOATING_POINT */
-    DWORD Fsr;
-
-    /* These are selected by CONTEXT_CONTROL */
-    DWORD Fir;
-    DWORD Psr;
-
-    DWORD ContextFlags;
-    DWORD Fill[2];
-} CONTEXT, *PCONTEXT;
-
-#endif  /* _MIPS_ */
-
-/* PowerPC context definitions */
-#ifdef __powerpc__
-
-#define CONTEXT_CONTROL         0x0001
-#define CONTEXT_FLOATING_POINT  0x0002
-#define CONTEXT_INTEGER         0x0004
-#define CONTEXT_DEBUG_REGISTERS 0x0008
-#define CONTEXT_FULL (CONTEXT_CONTROL | CONTEXT_FLOATING_POINT | CONTEXT_INTEGER)
-
-#define EXCEPTION_READ_FAULT    0
-#define EXCEPTION_WRITE_FAULT   1
-#define EXCEPTION_EXECUTE_FAULT 8
-
-typedef struct
-{
-    /* These are selected by CONTEXT_FLOATING_POINT */
-    double Fpr0;
-    double Fpr1;
-    double Fpr2;
-    double Fpr3;
-    double Fpr4;
-    double Fpr5;
-    double Fpr6;
-    double Fpr7;
-    double Fpr8;
-    double Fpr9;
-    double Fpr10;
-    double Fpr11;
-    double Fpr12;
-    double Fpr13;
-    double Fpr14;
-    double Fpr15;
-    double Fpr16;
-    double Fpr17;
-    double Fpr18;
-    double Fpr19;
-    double Fpr20;
-    double Fpr21;
-    double Fpr22;
-    double Fpr23;
-    double Fpr24;
-    double Fpr25;
-    double Fpr26;
-    double Fpr27;
-    double Fpr28;
-    double Fpr29;
-    double Fpr30;
-    double Fpr31;
-    double Fpscr;
-
-    /* These are selected by CONTEXT_INTEGER */
-    DWORD Gpr0;
-    DWORD Gpr1;
-    DWORD Gpr2;
-    DWORD Gpr3;
-    DWORD Gpr4;
-    DWORD Gpr5;
-    DWORD Gpr6;
-    DWORD Gpr7;
-    DWORD Gpr8;
-    DWORD Gpr9;
-    DWORD Gpr10;
-    DWORD Gpr11;
-    DWORD Gpr12;
-    DWORD Gpr13;
-    DWORD Gpr14;
-    DWORD Gpr15;
-    DWORD Gpr16;
-    DWORD Gpr17;
-    DWORD Gpr18;
-    DWORD Gpr19;
-    DWORD Gpr20;
-    DWORD Gpr21;
-    DWORD Gpr22;
-    DWORD Gpr23;
-    DWORD Gpr24;
-    DWORD Gpr25;
-    DWORD Gpr26;
-    DWORD Gpr27;
-    DWORD Gpr28;
-    DWORD Gpr29;
-    DWORD Gpr30;
-    DWORD Gpr31;
-
-    DWORD Cr;
-    DWORD Xer;
-
-    /* These are selected by CONTEXT_CONTROL */
-    DWORD Msr;
-    DWORD Iar; /* Instruction Address Register , aka PC ... */
-    DWORD Lr;
-    DWORD Ctr;
-
-    DWORD ContextFlags;
-    
-    DWORD Dar;   /* Fault registers for coredump */
-    DWORD Dsisr; 
-    DWORD Trap;  /* number of powerpc exception taken */
-
-    /* These are selected by CONTEXT_DEBUG_REGISTERS */
-    DWORD Dr0;
-    DWORD Dr1;
-    DWORD Dr2;
-    DWORD Dr3;
-    DWORD Dr4;
-    DWORD Dr5;
-    DWORD Dr6;
-    DWORD Dr7;
-} CONTEXT, *PCONTEXT;
-
-typedef struct _STACK_FRAME_HEADER
-{
-    DWORD BackChain;
-    DWORD GlueSaved1;
-    DWORD GlueSaved2;
-    DWORD Reserved1;
-    DWORD Spare1;
-    DWORD Spare2;
-
-    DWORD Parameter0;
-    DWORD Parameter1;
-    DWORD Parameter2;
-    DWORD Parameter3;
-    DWORD Parameter4;
-    DWORD Parameter5;
-    DWORD Parameter6;
-    DWORD Parameter7;
-} STACK_FRAME_HEADER,*PSTACK_FRAME_HEADER;
-
-#endif  /* __powerpc__ */
-
-#if !defined(CONTEXT_FULL) && !defined(RC_INVOKED)
-#error You need to define a CONTEXT for your CPU
-#endif
-
-NTSYSAPI void WINAPI RtlCaptureContext(CONTEXT*);
-
 #define WOW64_CONTEXT_i386 0x00010000
 #define WOW64_CONTEXT_i486 0x00010000
 #define WOW64_CONTEXT_CONTROL (WOW64_CONTEXT_i386 | __MSABI_LONG(0x00000001))
@@ -2409,20 +1069,6 @@
 } WOW64_CONTEXT, *PWOW64_CONTEXT;
 #include "poppack.h"
 
-#if defined(__x86_64__) || defined(__arm__) || defined(__aarch64__)
-
-typedef PRUNTIME_FUNCTION (CALLBACK *PGET_RUNTIME_FUNCTION_CALLBACK)(DWORD_PTR,PVOID);
-
-NTSYSAPI BOOLEAN CDECL  RtlAddFunctionTable(RUNTIME_FUNCTION*,DWORD,DWORD_PTR);
-NTSYSAPI DWORD   WINAPI RtlAddGrowableFunctionTable(void**,PRUNTIME_FUNCTION,DWORD,DWORD,ULONG_PTR,ULONG_PTR);
-NTSYSAPI BOOLEAN CDECL  RtlDeleteFunctionTable(RUNTIME_FUNCTION*);
-NTSYSAPI void    WINAPI RtlDeleteGrowableFunctionTable(void*);
-NTSYSAPI void    WINAPI RtlGrowFunctionTable(void*,DWORD);
-NTSYSAPI BOOLEAN CDECL  RtlInstallFunctionTableCallback(DWORD_PTR,DWORD_PTR,DWORD,PGET_RUNTIME_FUNCTION_CALLBACK,PVOID,PCWSTR);
-NTSYSAPI PRUNTIME_FUNCTION WINAPI RtlLookupFunctionEntry(DWORD_PTR,DWORD_PTR*,UNWIND_HISTORY_TABLE*);
-NTSYSAPI void    WINAPI RtlUnwindEx(PVOID,PVOID,struct _EXCEPTION_RECORD*,PVOID,CONTEXT*,UNWIND_HISTORY_TABLE*);
-#endif
-
 /*
  * Product types
  */
@@ -2664,57 +1310,6 @@
     DWORD64  ExceptionInformation[EXCEPTION_MAXIMUM_PARAMETERS];
 } EXCEPTION_RECORD64, *PEXCEPTION_RECORD64;
 
-/*
- * The exception pointers structure passed to exception filters
- * in except() and the UnhandledExceptionFilter().
- */
-
-typedef struct _EXCEPTION_POINTERS
-{
-  PEXCEPTION_RECORD  ExceptionRecord;
-  PCONTEXT           ContextRecord;
-} EXCEPTION_POINTERS, *PEXCEPTION_POINTERS;
-
-
-/*
- * The exception frame, used for registering exception handlers
- * Win32 cares only about this, but compilers generally emit
- * larger exception frames for their own use.
- */
-
-struct _EXCEPTION_REGISTRATION_RECORD;
-
-typedef DWORD (CDECL *PEXCEPTION_HANDLER)(PEXCEPTION_RECORD,struct _EXCEPTION_REGISTRATION_RECORD*,
-                                          PCONTEXT,struct _EXCEPTION_REGISTRATION_RECORD **);
-
-typedef struct _EXCEPTION_REGISTRATION_RECORD
-{
-  struct _EXCEPTION_REGISTRATION_RECORD *Prev;
-  PEXCEPTION_HANDLER       Handler;
-} EXCEPTION_REGISTRATION_RECORD;
-
-/*
- * function pointer to an exception filter
- */
-
-typedef LONG (CALLBACK *PVECTORED_EXCEPTION_HANDLER)(PEXCEPTION_POINTERS ExceptionInfo);
-
-typedef struct _NT_TIB
-{
-	struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList;
-	PVOID StackBase;
-	PVOID StackLimit;
-	PVOID SubSystemTib;
-	union {
-          PVOID FiberData;
-          DWORD Version;
-	} DUMMYUNIONNAME;
-	PVOID ArbitraryUserPointer;
-	struct _NT_TIB *Self;
-} NT_TIB, *PNT_TIB;
-
-struct _TEB;
-
 #if defined(__i386__) && defined(__GNUC__) && ((__GNUC__ > 3) || ((__GNUC__ == 3) && (__GNUC_MINOR__ >= 2)))
 static FORCEINLINE struct _TEB * WINAPI NtCurrentTeb(void)
 {
